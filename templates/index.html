<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Email Spam Classifier</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

    <style>
        :root{
            --bg1:#0f172a; --bg2:#0b1220;
            --card-bg: rgba(255,255,255,0.04);
            --accent1: #7c3aed; --accent2: #06b6d4;
            --muted: rgba(255,255,255,0.6);
            --glass: rgba(255,255,255,0.05);
            --success: linear-gradient(135deg,#16a34a,#4ade80);
            --danger: linear-gradient(135deg,#ef4444,#f97316);
        }
        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            font-family:"Poppins",system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
            color: #eef2ff;
            background: radial-gradient(1000px 400px at 10% 10%, rgba(124,58,237,0.12), transparent),
                        linear-gradient(180deg,var(--bg1),var(--bg2));
            -webkit-font-smoothing:antialiased;
            display:flex; align-items:center; justify-content:center;
            padding:40px;
        }

        .wrap{
            width:100%;
            max-width:900px;
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border: 1px solid rgba(255,255,255,0.04);
            border-radius:16px;
            padding:28px;
            box-shadow: 0 10px 30px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
            backdrop-filter: blur(6px);
            display:grid;
            grid-template-columns: 1fr 360px;
            gap:22px;
            align-items:start;
        }

        header{
            grid-column: 1 / -1;
            display:flex; align-items:center; gap:14px;
        }
        .brand {
            width:56px; height:56px; border-radius:12px;
            background: linear-gradient(135deg,var(--accent1),var(--accent2));
            display:flex; align-items:center; justify-content:center;
            font-weight:700; color:white; font-size:20px;
            box-shadow: 0 6px 20px rgba(12,12,20,0.45);
        }
        h2{margin:0; font-size:20px; font-weight:600; color:#eef2ff}
        p.lead{margin:4px 0 0; color:var(--muted); font-size:13px}

        form{display:flex; flex-direction:column; gap:12px}
        textarea{
            min-height:220px;
            max-height:420px;
            resize:vertical;
            padding:14px;
            border-radius:10px;
            border:1px solid rgba(255,255,255,0.04);
            background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));
            color:#e6eef8;
            font-size:14px;
            line-height:1.45;
            outline:none;
            transition: box-shadow .18s ease, transform .12s ease;
        }
        textarea:focus{ box-shadow: 0 8px 30px rgba(12,12,20,0.6); transform: translateY(-2px) }

        /* responsive controls: horizontal on wide screens, stacked on small screens */
        .controls{display:flex; align-items:center; justify-content:space-between; gap:12px}
        .hint{font-size:13px; color:var(--muted)}

        button[type="submit"]{
            appearance:none; border:0; cursor:pointer;
            padding:10px 18px; border-radius:10px;
            background: linear-gradient(90deg,var(--accent1),var(--accent2));
            color:white; font-weight:600; font-size:14px;
            box-shadow: 0 8px 30px rgba(124,58,237,0.18);
            display:inline-flex; gap:10px; align-items:center; justify-content:center;
            transition: transform .12s ease, box-shadow .12s ease, opacity .12s ease, width .12s ease;
            min-width:120px; /* keep a comfortable tap target on larger screens */
        }
        button[type="submit"]:hover{ transform: translateY(-3px) }
        button[disabled]{ opacity:.6; cursor:not-allowed; transform:none; box-shadow:none }

        /* ensure spinner and text align nicely inside the button */
        .btn-text { display:inline-block; }
        .spinner { margin-right:6px; }

        .sidebar{
            padding:18px;
            background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
            border-radius:12px;
            border:1px solid rgba(255,255,255,0.02);
            min-height:140px;
            display:flex; flex-direction:column; gap:12px;
        }

        .result{
            margin-top:6px;
            padding:14px;
            border-radius:10px;
            color: white;
            font-weight:700;
            display:flex; align-items:center; gap:12px;
            transform-origin:center;
            animation: pop .36s cubic-bezier(.2,.9,.3,1);
            box-shadow: 0 8px 24px rgba(2,6,23,0.6);
        }
        .result.ham{ background: var(--success); }
        .result.spam{ background: var(--danger); }

        @keyframes pop { from{ transform: scale(.88); opacity:0 } to{ transform: scale(1); opacity:1 } }

        .meta{ font-size:13px; color:var(--muted); margin-top:6px }

        .spinner {
            width:18px; height:18px; border-radius:50%;
            border:3px solid rgba(255,255,255,0.14);
            border-top-color: rgba(255,255,255,0.95);
            animation:spin 0.9s linear infinite;
        }
        @keyframes spin{ to{ transform: rotate(360deg) } }

        .sample{
            background: rgba(255,255,255,0.02);
            padding:10px; border-radius:8px; font-size:13px; color:var(--muted);
        }

        /* stack layout on medium/smaller screens */
        @media (max-width:880px){
            .wrap{ grid-template-columns: 1fr; padding:20px; }
            .sidebar{ order:-1 }
        }

        /* Make the classify button responsive: fill full width on narrow viewports */
        @media (max-width:600px){
            .controls{
                flex-direction:column;
                align-items:stretch;
                gap:10px;
            }
            /* hint stays above the button for clarity */
            .hint{ order:0; text-align:left; }
            button[type="submit"]{
                width:100%;
                min-width:unset;
                padding:12px 16px;
                justify-content:center;
            }
        }
    </style>
</head>
<body>
    <div class="wrap" role="main">
        <header>
            <div class="brand">ES</div>
            <div>
                <h2>Email Spam Classification</h2>
                <p class="lead">Paste an email to get a quick spam/ham prediction.</p>
            </div>
        </header>

        <form id="emailForm" method="post" novalidate>
            <textarea id="emailText" name="email" placeholder="Paste the full email text here..." required>{{ request.form.email or '' }}</textarea>

            <div class="controls">
                
                <button id="submitBtn" type="submit">
                    <span class="btn-text">Classify</span>
                </button>
            </div>

            <div class="meta">Press the Classify button to submit. Double submissions are prevented.</div>
        </form>

        <aside class="sidebar" aria-label="Result and help">
            <div>
                <strong>Result</strong>
                {% if prediction %}
                    <div class="result {{ prediction|lower }}">
                        <div class="badge">
                            {% if prediction|lower == 'spam' %}
                                <!-- spam icon -->
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M12 2l3 6 6 .5-4.5 3.5L19 20l-7-4-7 4 1.5-7L2 8.5 8 8 12 2z" fill="rgba(255,255,255,0.95)"/></svg>
                            {% else %}
                                <!-- ham icon -->
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M12 2a10 10 0 100 20 10 10 0 000-20z" fill="rgba(255,255,255,0.95)"/></svg>
                            {% endif %}
                        </div>
                        <div>{{ prediction }}</div>
                    </div>
                {% else %}
                    <div class="sample">No result yet. Submit an email to see whether it's spam.</div>
                {% endif %}
            </div>

            <div>
                <strong>Quick sample</strong>
                <div class="sample">
                    Dear user, you've won a prize! Click the link to claim.
                </div>
            </div>
        </aside>
    </div>

    <script>
        // Prevent double submits, show spinner.
        (function(){
            const form = document.getElementById('emailForm');
            const btn = document.getElementById('submitBtn');
            const btnText = btn.querySelector('.btn-text');
            let submitting = false;

            form.addEventListener('submit', function(e){
                if(submitting) {
                    e.preventDefault();
                    return;
                }
                submitting = true;
                btn.setAttribute('disabled','');
                // show spinner
                const spinner = document.createElement('span');
                spinner.className = 'spinner';
                btn.insertBefore(spinner, btn.firstChild);
                btnText.textContent = 'Classifying...';
            });

            // auto-resize textarea
            const ta = document.getElementById('emailText');
            const resize = () => {
                ta.style.height = 'auto';
                ta.style.height = Math.min(480, ta.scrollHeight) + 'px';
            };
            ta.addEventListener('input', resize);
            window.addEventListener('load', resize);
        })();
    </script>
</body>
</html>
